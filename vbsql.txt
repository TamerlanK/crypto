#Seviye 1
#1 - Iscilerin sayini tap
#SELECT count(*) FROM isci;
#2 - Iscileri maaslarina gore sirala (coxdan aza)
#SELECT * FROM isci ORDER BY maas DESC;
#3 - Mehsullari qiymetlerine gore sirala (coxdan aza)
#SELECT * FROM mehsul ORDER BY satisqiymeti DESC;
#4 - satis cedvelini satis tarixine gore sirala
#SELECT * FROM satis ORDER BY satistarixi;
#5 - Iscilerle vezifelerini birlesir
#SELECT ad, soyad, ataAdi, vezifead FROM isci INNER JOIN vezife ON isci.vezifeid = vezife.vezifeid;

#Seviye 2
#1 - Satis cedvelinde iscilerin ve mehsullarin adini, alis ve satis qiymetini, filialini ve endirimini goster
#select soyad, ad, mehsulad, satisqiymeti, alisqiymeti, filialad, endirim 
#from satis inner join mehsul on satis.mehsulid = mehsul.mehsulid
#inner join isci on isci.mkod = satis.isciid
#inner join filial on satis.filialid = filial.filialid;
#2 - Butun satislarin cemini tapin
#select format(sum(satisqiymeti*(100-endirim) / 100), 0)
#as umumiSatisCemi
#from satis inner join mehsul
#on satis.mehsulid = mehsul.mehsulid
#3 - Cari ayda mehsullarin satisindan gelen yekun meblegi tapin
#select format(sum(satisqiymeti*(100-endirim) / 100), 0)
#as cariAySatisMeblegi
#from satis inner join mehsul
#on satis.mehsulid = mehsul.mehsulid
#where month(satistarixi) = month(current_date());
#4 - cari ayda satilan mehsullardan sirketin elde etdiyi geliri tapin
#select format(sum(satisqiymeti*(100-endirim) / 100 - alisqiymeti), 0) as cariAyGelir from satis inner join mehsul
#on satis.mehsulid = mehsul.mehsulid
#where month(satistarixi) = month(current_date());
#5 - cari ayda her iscinin satdigi mehsullarin sayini tapin
#select isciid , count(isciid) 'satilan mehsul sayi' from satis
#where month(satistarixi) = month(current_date())
#group by isciid order by isciid;
#6 - cari ayda her iscinin satidigi mehsullarin yekun odenisini tapin
#select isciid, format(sum(satisqiymeti*(100-endirim) / 100 ), 0) as gelir
#from satis inner join mehsul
#on satis.mehsulid = mehsul.mehsulid
#where month(satistarixi) = month(current_date())
#group by isciid
#order by isciid;
#7 - cari ayda her iscinin satdigi mehsullardan qalan xeyri tap
#select isciid, format(sum(satisqiymeti*(100-endirim) / 100 - alisqiymeti), 0) as yekunGelir
#from satis inner join mehsul
#on satis.mehsulid = mehsul.mehsulid
#where month(satistarixi) = month(current_date())
#group by isciid
#order by isciid;
#8 - Bugun her filial uzre elde edilen gelir
#select format(sum(satisqiymeti*(100-endirim) / 100 ), 0) as filialGeliri,  filialad
#from satis inner join mehsul on satis.mehsulid = mehsul.mehsulid
#inner join filial on satis.filialid = filial.filialid
#where day(satistarixi) = day(current_date())
#group by filialad;
#9 - cari ayda her mehsuldan nece eded satildigini tap
#select mehsulad, count(mehsulad)
#from satis inner join mehsul on satis.mehsulid = mehsul.mehsulid
#inner join filial on satis.filialid = filial.filialid
#where month(satistarixi) = month(current_date())
#group by mehsulad;
#10 - cari ayda en cox satilan mehsul
#select mehsulad, count(mehsulad)
#from satis inner join mehsul on satis.mehsulid = mehsul.mehsulid
#inner join filial on satis.filialid = filial.filialid
#where month(satistarixi) = month(current_date())
#group by mehsulad
#order by count(mehsulad) desc
#limit 1;

#Seviye 3 
#1 -  ischilerin SAA, vezife ve stajini goster
#select ad, soyad, ata_adi, vezife,  format(datediff(current_date(), ise_baslama_tarixi) / 365, 0) as staj from iscisv3;
#2 - Iscilerin butun melumatari ile yanasi onlardan tutulan vergileri tapin
# maas 500e qeder olan isciler 5%
# maas 500den 800e qeder olan isciler 7%
# maas 800den 1500e qeder olan isciler 10%
# maas 1500den yuksek olan isciler 12%
#3 - Resmi maas, motivasiya maasi ve vergini nezere alaraq yekun maasi tap
#4 - Kassir vezifesinde calisan ve tecrubesi 3 ili kecen iscilerin motivasiya maaslarini 120 manat artir
#update iscisv3
#set motivasiya_maasi = motivasiya_maasi + 120
#where vezife = 'Kassir' and format(datediff(current_date(), ise_baslama_tarixi) / 365, 0) > 3;
#5 - Iscinin ise baslama muddetinden 6 ay kecibse maasini 10% artir
#update iscisv3
#set resmi_maas = resmi_maas / 100 * 110
#where format(datediff(current_date(), ise_baslama_tarixi) / 30, 0) > 6;



